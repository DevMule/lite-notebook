!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(module,__webpack_exports__,__webpack_require__){"use strict";async function parse(ch,element){ch.flags.indexOf("async")>=0?await eval(ch.content):eval(ch.content)}const js_parser={types:["js","javascript","java-script"],parse:parse};__webpack_exports__.a=js_parser},function(e,t,n){"use strict";n.r(t);class r{constructor(){this.chunks=[],this.tail=[],this.current=null,this.line=0,this.index=0}commit(){const e=this.current;e.commit(),this.chunks.push(e),this.current=null}addLines(e){this.current.addLines(e),this.line+=e.length;for(const t of e)this.index+=t.length+1}}class i{constructor(e,t,n,r){this.type=e,this.flags=t,this.index=n,this.startLine=r,this.endLine=r,this.content="",this.lines=[]}addLines(e){this.lines.push(...e),this.endLine+=e.length}commit(){this.content=this.lines.join("\n"),this.lines=[]}}function s(e,t,n=!0){const r=t.split("\n");let s=[];return r.forEach((function(t){if("%%"===t.slice(0,2)){s.length&&!e.current&&(e.current=new i("",[],0,0)),e.current&&(e.addLines(s),e.commit(),s=[]);let n=0;for(;"%"===t[n];)n+=1;const r=t.slice(n).split(/[ \t]+/).filter(e=>""!==e);e.current=new i(r[0],r.slice(1),e.index,e.line),e.index+=t.length+1}else s.push(t)})),n?(e.addLines(s),e.commit(),e.tail=[]):e.tail.push(...s),e}const o={};o.ParserState=r,o.Chunk=i,o.parseLines=s,o.parse=function(e){return s(new r,e,!0).chunks};var a=o;var c={types:["css"],parse:async function(e,t){let n=document.createElement("style");n.appendChild(document.createTextNode(e.content)),t.appendChild(n)}},l=n(0);async function d(e){let t=e.indexOf(":");if(t<0)return;let n=e.slice(0,t).trim(),r=e.slice(t+1,e.length).trim();if(n&&r)switch(n){case"js":await async function(e){return new Promise((t,n)=>{let r=document.createElement("script");document.head.appendChild(r),r.src=e,r.async=!1,r.onload=t,r.onerror=n})}(r);break;case"py":await async function(e){return await languagePluginLoader,pyodide.loadPackage([e])}(r);break;case"text":await async function(e){let t=e.indexOf("=");if(t<0)return;let n=e.slice(0,t).trim(),r=e.slice(t+1,e.length).trim();if(r.startsWith("http")||(r=lite_notebook.root+"/"+r),n&&r){let e=await fetch(r);self[n]=await e.text()}}(r)}}var u={types:["fetch"],parse:async function(e,t){let n=e.content.split("\n");for(let e=0;e<n.length;e++){let t=n[e].trim();t&&await d(t)}}};let p=null;var h={types:["md"],parse:async function(e,t){if(!p){p=new marked.Renderer;const e=p.link.bind(p),t=p.image.bind(p);p.link=(t,n,r)=>(t.startsWith("http")||(t=lite_notebook.root+"/"+t),e(t,n,r)),p.image=(e,n,r)=>(e.startsWith("http")||(e=lite_notebook.root+"/"+e),t(e,n,r))}let n=document.createElement("div");n.innerHTML=marked(e.content,{renderer:p}),n.classList&&n.classList.add("user-markdown"),t.appendChild(n)}};var f={types:["editor","code","ace"],parse:async function(e,t){let n=document.createElement("div");n.innerText=e.content;for(let t=0;t<e.flags.length;t++){let r=e.flags[t];if(r.startsWith("id")){let e=r.indexOf("=");if(e<0)continue;n.id=r.slice(e+1,r.length).trim()}}t.appendChild(n);const r=ace.edit("editor");r.getSession().setMode("ace/mode/python"),r.setOptions({maxLines:60,minLines:20})}};const m=[c,l.a,u,h,f];const y={root:"",hierarchy:{},screen:null,workerURL:"dist/worker.js",elements:{code_output:function(){let e=document.createElement("div");e.classList.add("code-output");let t=document.createElement("div");t.classList.add("code-btn-container"),e.appendChild(t);let n=document.createElement("div");n.classList.add("code-btn","code-btn-play"),t.appendChild(n);let r=document.createElement("div");r.classList.add("code-btn","code-btn-clear"),t.appendChild(r);let i=document.createElement("div");return i.classList.add("code-output-text"),e.appendChild(i),n.addEventListener("click",()=>e.dispatchEvent(new Event("onPlay"))),r.addEventListener("click",()=>e.dispatchEvent(new Event("onClear"))),e.output=i,e.attachEditor=t=>{let r=null;e.addEventListener("onPlay",()=>{r?(n.classList.remove("code-btn-stop"),n.classList.add("code-btn-play")):(r=lite_notebook.pyWorker,r.addEventListener("print",e=>{i.innerText+=String(e.message).replace(/\\n/g,"<br>")+"\n",i.scrollTop=i.scrollHeight}),r.run(t.getValue(),{},e=>{i.innerText+="process finished\n",i.scrollTop=i.scrollHeight,r.terminate(),r=null,n.classList.remove("code-btn-stop"),n.classList.add("code-btn-play")},e=>{i.innerText+=e.replace(/\\n/g,"<br>")+"\n",i.scrollTop=i.scrollHeight,r.terminate(),r=null,n.classList.remove("code-btn-stop"),n.classList.add("code-btn-play")}),n.classList.remove("code-btn-play"),n.classList.add("code-btn-stop"),i.innerText+="run...\n",i.scrollTop=i.scrollHeight)}),e.addEventListener("onClear",()=>i.innerText="")},e}},render_path:w,load_hierarchy:async function(e){let t=await fetch(e),n=await t.text();if(n){y.hierarchy=JSON.parse(n);let e=new URL(window.location.href).searchParams.get("page")||"notebooks";await w(e)}},get pyWorker(){return e=y.workerURL,{worker:new Worker(e),listeners:[],run:function(e,t,n,r){this.worker.onerror=r,this.worker.onmessage=e=>{const{results:t,error:i}=e.data;for(let t=0;t<this.listeners.length;t++)if(e.data.type===this.listeners[t].type)try{this.listeners[t].listener(e.data)}catch(e){console.error(e.message)}"end"===e.data.type&&n(e.data),i&&r(i)},this.worker.postMessage({...t,python:e})},asyncRun:function(e,t){return new Promise((n,r)=>this.run(e,t,n,r))},addEventListener(e,t){this.listeners.push({type:e,listener:t})},terminate(){this.worker.terminate()}};var e}};async function w(e){let{node:t,root:n}=await async function(e){let t=e.split("/"),n=y.hierarchy,r=[n.src],i=0;for(;n.src===t[i]&&(i++,i<t.length);){let e=t[i],s=n.children.find(t=>t.src===e);if(!s)break;n=s,r.push(n.src)}return{node:n,root:r.join("/")}}(e);if(t){document.title=t.name;const e=window.location.href.split("?");window.history.pushState(null,null,e[0]+"?page="+n),y.root=n,y.screen=document.getElementById("screen");let r=await fetch(n+"/notebook"),i=await r.text();await async function(e,t){let n=a.parse(e);for(let e=0;e<n.length;e++){let r=n[e];if(!r.type)continue;let i=r.type.trim().toLowerCase(),s=m.find(e=>e.types.indexOf(i)>=0);s&&await s.parse(r,t)}}(i,y.screen)}else await w("notebooks")}window.lite_notebook=y}]);